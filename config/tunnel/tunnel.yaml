appName: "tunnel"
log:
  level: debug
  destinations:
    - type: stdout
  contextKeys:
    - transaction_id
    - message_id
    - subscriber_id
    - module_id
http:
  port: 8083
  timeout:
    read: 30
    write: 30
    idle: 30
pluginManager:
  root: ./plugins
modules:
  - name: tunnelForward
    path: /tunnel/forward/
    handler:
      type: std
      role: bap
      httpClientConfig:
        maxIdleConns: 1000
        maxIdleConnsPerHost: 200
        idleConnTimeout: 300s
        responseHeaderTimeout: 5s
      plugins:
        registry:
          id: dediregistry
          config:
            url: http://34.14.173.68:8080/dedi
            registryName: subscribers.beckn.one
            timeout: 10
            retry_max: 3
            retry_wait_min: 1s
            retry_wait_max: 5s
        router:
          id: router
          config:
            routingConfig: ./config/tunnel/tunnel-routing-forward.yaml
      steps:
        - addRoute
  
  - name: tunnelCallback
    path: /tunnel/callback/
    handler:
      type: std
      role: bpp
      httpClientConfig:
        maxIdleConns: 1000
        maxIdleConnsPerHost: 200
        idleConnTimeout: 300s
        responseHeaderTimeout: 5s
      plugins:
        registry:
          id: dediregistry
          config:
            url: http://34.14.173.68:8080/dedi
            registryName: subscribers.beckn.one
            timeout: 10
            retry_max: 3
            retry_wait_min: 1s
            retry_wait_max: 5s
        router:
          id: router
          config:
            routingConfig: ./config/tunnel/tunnel-routing-callback.yaml
      steps:
        - addRoute
